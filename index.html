<html>
<head>
    <script src="socket.io.js"></script>
    <title>Home Page</title>
</head>

<body>
<h1>Razna hakovanja...</h1>

<textarea style="height: 30%; width: 30%" id="filter-input"></textarea>
<button id="change-query">Change Query</button>
<button id="get-heatmap">Get Entire Heatmap</button> <br><br>
<h3>Heatmap Data</h3>
<ul id="display"></ul>
<br><br>
<h3>Mutations</h3>
<hl id="mutation-display"></hl>
<br><br>
<h3>Errors</h3>
<ul id="err-display"></ul>


<script>
	const filterInput = document.getElementById('filter-input');
    const changeQueryButton = document.getElementById('change-query');
	const getHeatmapButton = document.getElementById('get-heatmap');
	const display = document.getElementById('display');
	const mutationDisplay = document.getElementById('mutation-display');
	const errDisplay = document.getElementById('err-display');

	//const socket = io('https://store-heatmap-api.dev.augustusny.com/');
	const socket = io('http://localhost:3001');
	socket.on('aggregation-response', function(data) {
		const li = document.createElement('li');
		li.appendChild(document.createTextNode(JSON.stringify(data)));
		display.appendChild(li);
    });

	socket.on('heatmap-mutation', function(data) {
		const li = document.createElement('li');
		li.appendChild(document.createTextNode(JSON.stringify(data)));
		mutationDisplay.appendChild(li);
    });

	socket.on('error-report', function(data) {
		const li = document.createElement('li');
		li.appendChild(document.createTextNode(JSON.stringify(data)));
		errDisplay.appendChild(li);
    });

	changeQueryButton.addEventListener('click', function() {
		const filters = JSON.parse(filterInput.value);
		socket.emit('set-filters', filters);
    });

	getHeatmapButton.addEventListener('click', function() {
        socket.emit('aggregation-request', { start_hour: 0, end_hour: 24 });
	});

</script>
</body>
</html>
